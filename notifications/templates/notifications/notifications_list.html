{% extends 'base.html' %}
{% block title %}Notifications{% endblock %}
{% block content %}

{% if messages %}
<div class="alert alert-secondary alert-dismissible fade show" role="alert">
  {% for message in messages %}
    {{ message }}
  {% endfor %}
  <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
</div>
{% endif %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h3 mb-0"> Notifications</h1>
  <button class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#addNotificationModal">+ Add Notification</button>
</div>

<!-- Add Notification Modal -->
<div class="modal fade" id="addNotificationModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add Notification</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <form method="post">
        {% csrf_token %}
        <div class="modal-body">
          {{ form.non_field_errors }}
          <div class="mb-3">
            <label for="{{ form.message.id_for_label }}" class="form-label">{{ form.message.label }}</label>
            {{ form.message }}
          </div>
          <div class="mb-3">
            <label for="{{ form.scheduled_for.id_for_label }}" class="form-label">{{ form.scheduled_for.label }}</label>
            {{ form.scheduled_for }}
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-secondary"> Save Notification</button>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="card">
  <h2 class="text-xl font-semibold mb-2">Your Notifications</h2>
  <table class="min-w-full table-auto">
    <thead>
      <tr class="bg-gray-200">
        <th class="px-2 py-1">Message</th>
        <th class="px-2 py-1">Created</th>
        <th class="px-2 py-1">Scheduled</th>
        <th class="px-2 py-1">Read</th>
      </tr>
    </thead>
    <tbody>
      {% for n in notifications %}
      <tr class="border-b">
        <td class="px-2 py-1">{{ n.message }}</td>
        <td class="px-2 py-1">{{ n.created_at }}</td>
        <td class="px-2 py-1">{{ n.scheduled_for|default:'-' }}</td>
        <td class="px-2 py-1">{% if n.is_read %}Yes{% else %}No{% endif %}</td>
      </tr>
      {% empty %}
      <tr><td colspan="4" class="text-center py-2">No notifications yet.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}