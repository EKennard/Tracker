{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}GetLizzyFit{% endblock %}</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/cartoon-theme.css' %}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    {% block extra_head %}{% endblock %}
</head>
<body>
    {% if user.is_authenticated %}
        <!-- Burger Menu Button (Mobile) -->
        {% if request.path != '/users/create-profile/' %}
        <button id="burger-menu" class="burger-menu" onclick="toggleMenu()">
            <div class="burger-icon">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        {% endif %}
        
        <!-- Main Navbar -->
        <nav id="main-navbar" class="main-navbar">
            <div class="navbar-container">
                <div class="navbar-brand">
                    <div class="brand-icons">
                        <img src="{% static 'icons/apple-doodle.svg' %}" class="icon" alt="Meals">
                        <img src="{% static 'icons/heart-doodle.svg' %}" class="icon" alt="Health">
                        <img src="{% static 'icons/checklist-doodle.svg' %}" class="icon" alt="Habits">
                        <img src="{% static 'icons/calendar-doodle.svg' %}" class="icon" alt="Fertility">
                        <img src="{% static 'icons/user-doodle.svg' %}" class="icon" alt="Profile">
                    </div>
                    <h1 class="brand-title">
                        <a href="/">GetLizzyFit</a>
                    </h1>
                </div>
                
                {% if request.path != '/users/create-profile/' %}
                <div id="navbar-links" class="navbar-links">
                    <a href="/users/dashboard/" class="nav-link">ğŸ  Dashboard</a>
                    <a href="/meals/log/" class="nav-link">ğŸ Meals</a>
                    <a href="/exercise/log/" class="nav-link">ğŸ’ª Exercise</a>
                    <a href="/habits/log/" class="nav-link">âœ… Habits</a>
                    <a href="/fertility/" class="nav-link">ğŸŒ¸ Fertility</a>
                    <a href="/metrics/summary/" class="nav-link">ğŸ“ Metrics</a>
                    <a href="/milestones/list/" class="nav-link">ğŸ¯ Milestones</a>
                    <a href="/social/feed/" class="nav-link">ğŸŒ Feed</a>
                    <a href="/social/search/" class="nav-link">ğŸ” Find Friends</a>
                    <a href="/social/friend-requests/" class="nav-link">ğŸ‘¥ Friends</a>
                    <a href="/social/groups/" class="nav-link">ğŸ‘« Groups</a>
                    <a href="/notifications/list/" class="nav-link">ğŸ”” Notifications</a>
                </div>
                {% endif %}
                
                <div class="navbar-user">
                    <span class="user-name">ğŸ‘¤ {{ user.username }}</span>
                    <a href="/accounts/logout/" class="logout-button">ğŸšª Logout</a>
                </div>
            </div>
        </nav>
    {% else %}
        <header class="card" style="display:flex;flex-direction:column;align-items:center;justify-content:center;gap:0.25rem;text-align:center;">
            <div style="display:flex;justify-content:center;align-items:center;gap:0.5rem;">
                <img src="{% static 'icons/apple-doodle.svg' %}" class="icon" alt="Meals">
                <img src="{% static 'icons/heart-doodle.svg' %}" class="icon" alt="Health">
                <img src="{% static 'icons/checklist-doodle.svg' %}" class="icon" alt="Habits">
                <img src="{% static 'icons/calendar-doodle.svg' %}" class="icon" alt="Fertility">
                <img src="{% static 'icons/user-doodle.svg' %}" class="icon" alt="Profile">
            </div>
            <h1 style="margin-top:0.15rem;margin-bottom:0;font-family:'Fredoka One','Comic Neue',sans-serif;font-size:1.5rem;">
                <a href="/" style="color:#4FC3F7;text-decoration:none;">GetLizzyFit</a>
            </h1>
        </header>
        <nav class="card" style="display:flex;flex-wrap:wrap;gap:0.25rem;align-items:center;justify-content:center;margin-bottom:0.5rem;">
            <a href="/accounts/login/" class="button">Login</a>
        </nav>
    {% endif %}
    
    <!-- Django Messages - Fixed position overlay -->
    {% if messages %}
        <div id="messages-container">
            {% for message in messages %}
                <div class="toast-message message-{{ message.level_tag }}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
        <script>
            // Auto-fade messages after 3 seconds
            setTimeout(function() {
                const messages = document.querySelectorAll('.toast-message');
                messages.forEach(function(msg) {
                    msg.style.opacity = '0';
                    setTimeout(function() {
                        msg.remove();
                        const container = document.getElementById('messages-container');
                        if (container && container.children.length === 0) {
                            container.remove();
                        }
                    }, 500);
                });
            }, 3000);
        </script>
    {% endif %}
    
    <main class="main-section">
        {% block content %}
            {% if user.is_authenticated %}
                <div class="section-title">Welcome back, {{ user.username }}!</div>
            {% else %}
                <div class="welcome-title">Welcome to GetLizzyFit!</div>
                <div class="welcome-desc">
                    GetLizzyFit is your all-in-one health, fitness, and wellness tracker. Log your meals, track your habits, monitor your health metrics, and connect with friends for motivation. Our app helps you build healthy routines, celebrate milestones, and stay on top of your goals in a fun, supportive environment.
                </div>
                <div class="feature-card">
                    <img src="{% static 'icons/apple-doodle.svg' %}" class="feature-icon" alt="Meals">
                    <div class="feature-info">
                        <div class="feature-title">Meal Logging</div>
                        <div class="feature-desc">Easily log your daily meals, track nutrition, and spot healthy eating patterns.</div>
                    </div>
                </div>
                <div class="feature-card">
                    <img src="{% static 'icons/heart-doodle.svg' %}" class="feature-icon" alt="Health">
                    <div class="feature-info">
                        <div class="feature-title">Health Metrics</div>
                        <div class="feature-desc">Monitor your health stats, including weight, heart rate, and more, all in one place.</div>
                    </div>
                </div>
                <div class="feature-card">
                    <img src="{% static 'icons/checklist-doodle.svg' %}" class="feature-icon" alt="Habits">
                    <div class="feature-info">
                        <div class="feature-title">Habit Tracking</div>
                        <div class="feature-desc">Build and maintain healthy habits with daily tracking and reminders.</div>
                    </div>
                </div>
                <div class="feature-card">
                    <img src="{% static 'icons/calendar-doodle.svg' %}" class="feature-icon" alt="Fertility">
                    <div class="feature-info">
                        <div class="feature-title">Fertility & Calendar</div>
                        <div class="feature-desc">Track fertility cycles and important dates with our integrated calendar.</div>
                    </div>
                </div>
                <div class="feature-card">
                    <img src="{% static 'icons/user-doodle.svg' %}" class="feature-icon" alt="Profile">
                    <div class="feature-info">
                        <div class="feature-title">Social & Community</div>
                        <div class="feature-desc">Connect with friends, join groups, and celebrate milestones together.</div>
                    </div>
                </div>
            {% endif %}
        {% endblock %}
    </main>
    <footer style="text-align:center;margin-top:0.5rem;color:#81C784;font-size:0.85rem;">
        &copy; {{ now.year }} GetLizzyFit. All rights reserved.
    </footer>
    
    <script>
        // Toggle burger menu
        function toggleMenu() {
            const navLinks = document.getElementById('navbar-links');
            const burger = document.getElementById('burger-menu');
            if (navLinks) {
                navLinks.classList.toggle('active');
            }
            if (burger) {
                burger.classList.toggle('active');
            }
        }
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const navLinks = document.getElementById('navbar-links');
            const burger = document.getElementById('burger-menu');
            
            if (navLinks && burger && navLinks.classList.contains('active')) {
                if (!navLinks.contains(event.target) && !burger.contains(event.target)) {
                    navLinks.classList.remove('active');
                    burger.classList.remove('active');
                }
            }
        });
    </script>
    
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
