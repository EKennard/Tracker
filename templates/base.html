{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}GetLizzyFit{% endblock %}</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    {% block extra_head %}{% endblock %}
</head>
<body>
    {% if user.is_authenticated %}
        {% if request.path != '/users/create-profile/' %}
        <!-- Bootstrap Navbar -->
        <nav class="navbar sticky-top p-1">
            <div class="container-fluid px-2">
                <div class="d-flex justify-content-between align-items-center w-100">
                    <!-- Brand -->
                    <a class="navbar-brand fw-bold mb-0" href="/users/dashboard/">
                        <span>GetLizzyFit</span>
                    </a>
                    
                    <!-- Toggler (all screens) -->
                    <button class="navbar-toggler p-1" type="button" data-bs-toggle="offcanvas" data-bs-target="#navbarOffcanvas" aria-controls="navbarOffcanvas">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
            </div>
        </nav>
        
        <!-- Bootstrap Offcanvas for Mobile -->
        <div class="offcanvas offcanvas-end" tabindex="-1" id="navbarOffcanvas">
            <div class="offcanvas-header">
                <h5 class="offcanvas-title">Menu</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
            </div>
            <div class="offcanvas-body p-0">
                <div class="d-flex flex-column">
                    <div class="p-3 border-bottom">
                        <div class="small mb-2 fw-bold">{{ user.username }}</div>
                        <a href="/accounts/logout/" class="btn btn-sm w-100">Logout</a>
                    </div>
                    <a href="/users/dashboard/" class="p-3 border-bottom text-decoration-none">Dashboard</a>
                    <a href="/users/log/" class="p-3 border-bottom text-decoration-none">Log Activities</a>
                    <a href="/users/profile/" class="p-3 border-bottom text-decoration-none">Profile & Settings</a>
                    <a href="/social/" class="p-3 border-bottom text-decoration-none">Social</a>
                </div>
            </div>
        </div>
        {% endif %}
    {% else %}
        <div class="card m-3 p-3 text-center">
            <h1 class="h3 mb-0">
                <a href="/" class="text-decoration-none">GetLizzyFit</a>
            </h1>
        </div>
        <div class="text-center mb-3">
            <a href="/accounts/login/" class="btn">Login</a>
        </div>
    {% endif %}
    
    <!-- Django Messages with Bootstrap Toast -->
    {% if messages %}
        <div class="position-fixed top-0 end-0 p-3" style="z-index: 9999">
            {% for message in messages %}
                <div class="toast show align-items-center text-white bg-{% if message.level_tag == 'error' %}danger{% elif message.level_tag == 'success' %}success{% elif message.level_tag == 'warning' %}warning{% else %}info{% endif %} border-0" role="alert">
                    <div class="d-flex p-2">
                        <div class="toast-body">{{ message }}</div>
                        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                    </div>
                </div>
            {% endfor %}
        </div>
        <script>
            // Auto-hide toasts after 3 seconds
            setTimeout(function() {
                const toasts = document.querySelectorAll('.toast');
                toasts.forEach(toast => {
                    const bsToast = bootstrap.Toast.getOrCreateInstance(toast);
                    bsToast.hide();
                });
            }, 3000);
        </script>
    {% endif %}
    
    <main class="container-fluid p-2 p-md-3">
        {% block content %}
            {% if user.is_authenticated %}
                <h2 class="mb-3">Welcome back, {{ user.username }}!</h2>
            {% else %}
                <div class="row g-3 py-5">
                    <div class="col-12 text-center mb-4">
                        <h1 class="display-4 mb-3">Welcome to GetLizzyFit!</h1>
                        <p class="lead px-3">
                            GetLizzyFit is your all-in-one health, fitness, and wellness tracker. Log your meals, track your habits, monitor your body stats, and connect with friends for motivation. Our app helps you build healthy routines, celebrate milestones, and stay on top of your goals in a fun, supportive environment.
                        </p>
                    </div>
                    
                    <div class="col-md-6 col-lg-4 mb-3">
                        <div class="card h-100">
                            <div class="card-body p-4">
                                <h5 class="card-title mb-2">Meal Logging</h5>
                                <p class="card-text mb-0">Easily log your daily meals, track nutrition, and spot healthy eating patterns.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 col-lg-4 mb-3">
                        <div class="card h-100">
                            <div class="card-body p-4">
                                <h5 class="card-title mb-2">Body Stats</h5>
                                <p class="card-text mb-0">Monitor your health stats, including weight, heart rate, and more, all in one place.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 col-lg-4 mb-3">
                        <div class="card h-100">
                            <div class="card-body p-4">
                                <h5 class="card-title mb-2">Habit Tracking</h5>
                                <p class="card-text mb-0">Build and maintain healthy habits with daily tracking and reminders.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 col-lg-4 mb-3">
                        <div class="card h-100">
                            <div class="card-body p-4">
                                <h5 class="card-title mb-2">Fertility & Calendar</h5>
                                <p class="card-text mb-0">Track fertility cycles and important dates with our integrated calendar.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 col-lg-4 mb-3">
                        <div class="card h-100">
                            <div class="card-body p-4">
                                <h5 class="card-title mb-2">Social & Community</h5>
                                <p class="card-text mb-0">Connect with friends, join groups, and celebrate milestones together.</p>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
        {% endblock %}
    </main>
    
    <footer class="text-center py-3 mt-auto">
        &copy; {{ now.year }} GetLizzyFit. All rights reserved.
    </footer>
    
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
