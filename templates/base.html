{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}GetLizzyFit{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/cartoon-theme.css' %}">
    <style>
        body {
            min-height: 100vh;
            margin: 0;
            padding: 0;
            background: #FFF8F0;
            overflow-x: hidden;
        }
        .main-section {
            max-width: 900px;
            margin: 2rem auto;
            background: #fff8f0;
            border-radius: 2rem;
            box-shadow: 0 4px 24px rgba(186,104,200,0.08);
            padding: 2.5rem 2rem 2rem 2rem;
            width: 90%;
            box-sizing: border-box;
        }
        .feature-card {
            display: flex;
            align-items: center;
            background: #FFFFFF;
            border: 2px dashed #FFD54F;
            border-radius: 1.5rem;
            box-shadow: 0 2px 8px rgba(255,213,79,0.12);
            padding: 1.5rem;
            margin: 2rem 0;
            transition: transform 0.2s;
            flex-wrap: wrap;
        }
        .feature-card:hover {
            transform: scale(1.03) rotate(-2deg);
            box-shadow: 0 8px 24px rgba(79,195,247,0.15);
        }
        .feature-icon {
            width: 60px;
            height: 60px;
            margin-right: 1.5rem;
            filter: drop-shadow(0 2px 2px #BA68C8);
            flex-shrink: 0;
        }
        .feature-info {
            flex: 1;
            min-width: 200px;
        }
        .feature-title {
            color: #4FC3F7;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            font-family: 'Fredoka One', 'Comic Neue', sans-serif;
        }
        .feature-desc {
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 1rem;
        }
        .cta {
            margin-top: 2rem;
            text-align: center;
        }
        .welcome-title {
            color: #4FC3F7;
            font-size: 2.2rem;
            margin-bottom: 1rem;
            font-family: 'Fredoka One', 'Comic Neue', sans-serif;
        }
        .welcome-desc {
            font-size: 1.25rem;
            color: #333;
            margin-bottom: 2rem;
        }
        
        /* Logout button hover effect */
        .logout-button:hover {
            background: #E74C3C !important;
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(231,76,60,0.4) !important;
        }
        
        /* Dropdown styles */
        .dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-btn {
            cursor: pointer;
            user-select: none;
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            background: white;
            min-width: 200px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-radius: 1rem;
            z-index: 100;
            border: 2px dashed #FFD54F;
            margin-top: 0.5rem;
        }
        
        .dropdown-content a {
            color: #333;
            padding: 0.75rem 1.25rem;
            text-decoration: none;
            display: block;
            transition: all 0.3s;
            border-radius: 0.8rem;
            margin: 0.25rem;
        }
        
        .dropdown-content a:hover {
            background: #E1F5FE;
            transform: translateX(5px);
        }
        
        .dropdown.active .dropdown-content {
            display: block;
        }
        
        /* Burger menu animations */
        .burger-menu.active {
            background: #BA68C8 !important;
        }
        
        .burger-menu.active .burger-icon span:nth-child(1) {
            transform: rotate(45deg) translate(8px, 8px);
        }
        
        .burger-menu.active .burger-icon span:nth-child(2) {
            opacity: 0;
        }
        
        .burger-menu.active .burger-icon span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -7px);
        }
        
        /* Mobile responsive styles */
        @media (max-width: 768px) {
            .main-section {
                margin: 1rem auto;
                padding: 1.5rem 1rem;
                width: 95%;
                border-radius: 1rem;
            }
            .welcome-title {
                font-size: 1.8rem;
            }
            .welcome-desc {
                font-size: 1rem;
            }
            .feature-card {
                flex-direction: column;
                text-align: center;
                padding: 1rem;
            }
            .feature-icon {
                margin-right: 0;
                margin-bottom: 1rem;
            }
            .feature-title {
                font-size: 1.3rem;
            }
            .feature-desc {
                font-size: 1rem;
            }
            header .icon {
                width: 36px !important;
                height: 36px !important;
            }
            header h1 {
                font-size: 1.8rem !important;
            }
            
            /* Mobile menu styles */
            #burger-menu {
                display: block !important;
            }
            
            .main-nav {
                display: none !important;
                position: fixed;
                top: 60px;
                left: 0;
                right: 0;
                width: 100%;
                max-width: 100%;
                flex-direction: column !important;
                z-index: 1000;
                padding: 1rem !important;
                margin: 0 !important;
                border-radius: 0 !important;
                max-height: calc(100vh - 60px);
                overflow-y: auto;
            }
            
            .main-nav.active {
                display: flex !important;
            }
            
            .main-nav .button,
            .main-nav .dropdown {
                width: 100%;
            }
            
            .dropdown-content {
                position: relative;
                margin-top: 0.5rem;
                box-shadow: none;
                border: 2px solid #4FC3F7;
            }
            
            /* Adjust header on mobile to accommodate burger menu */
            header.card {
                padding-right: 60px !important;
            }
            
            /* User info stacking on mobile */
            header.card > div:last-child {
                flex-direction: column;
                gap: 0.5rem !important;
            }
            
            .logout-button {
                font-size: 0.9rem !important;
                padding: 0.4rem 1rem !important;
            }
        }
    </style>
    {% block extra_head %}{% endblock %}
</head>
<body>
    {% if user.is_authenticated %}
        <header class="card" style="display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1rem;text-align:center;">
            <div style="display:flex;justify-content:center;align-items:center;gap:2.5rem;">
                <img src="{% static 'icons/apple-doodle.svg' %}" class="icon" alt="Meals">
                <img src="{% static 'icons/heart-doodle.svg' %}" class="icon" alt="Health">
                <img src="{% static 'icons/checklist-doodle.svg' %}" class="icon" alt="Habits">
                <img src="{% static 'icons/calendar-doodle.svg' %}" class="icon" alt="Fertility">
                <img src="{% static 'icons/user-doodle.svg' %}" class="icon" alt="Profile">
            </div>
            <h1 style="margin-top:1rem;margin-bottom:0;font-family:'Fredoka One','Comic Neue',sans-serif;font-size:2.5rem;">
                <a href="/" style="color:#4FC3F7;text-decoration:none;">GetLizzyFit</a>
            </h1>
            <div style="display:flex;align-items:center;gap:1rem;margin-top:0.5rem;">
                <span style="color:#BA68C8;font-size:1.1rem;font-weight:bold;">ğŸ‘¤ {{ user.username }}</span>
                <a href="/accounts/logout/" class="logout-button" style="background:#FF6B6B;color:white;padding:0.5rem 1.5rem;border-radius:1rem;text-decoration:none;font-weight:bold;box-shadow:0 2px 8px rgba(255,107,107,0.3);transition:all 0.3s;">ğŸšª Logout</a>
            </div>
        </header>
        
        <!-- Burger Menu Button (Mobile) -->
        <button id="burger-menu" class="burger-menu" onclick="toggleMenu()" style="display:none;position:fixed;top:0.5rem;right:0.5rem;z-index:1001;background:#4FC3F7;border:3px solid #BA68C8;border-radius:50%;width:50px;height:50px;cursor:pointer;box-shadow:0 4px 12px rgba(79,195,247,0.4);transition:all 0.3s;padding:0;">
            <div class="burger-icon">
                <span style="display:block;width:24px;height:2.5px;background:white;margin:4px auto;border-radius:2px;transition:all 0.3s;"></span>
                <span style="display:block;width:24px;height:2.5px;background:white;margin:4px auto;border-radius:2px;transition:all 0.3s;"></span>
                <span style="display:block;width:24px;height:2.5px;background:white;margin:4px auto;border-radius:2px;transition:all 0.3s;"></span>
            </div>
        </button>
        
        <!-- Navigation Menu -->
        <nav id="main-nav" class="card main-nav" style="display:flex;flex-wrap:wrap;gap:1rem;align-items:center;justify-content:center;margin-bottom:2rem;">
            <a href="/users/dashboard/" class="button">ğŸ  Dashboard</a>
            
            <!-- Tracking Dropdown -->
            <div class="dropdown">
                <button class="button dropdown-btn" onclick="toggleDropdown(event, 'tracking-menu')">ğŸ“Š Tracking â–¼</button>
                <div id="tracking-menu" class="dropdown-content">
                    <a href="/meals/log/">ğŸ Meals</a>
                    <a href="/exercise/log/">ğŸ’ª Exercise</a>
                    <a href="/habits/log/">âœ… Habits</a>
                    <a href="/fertility/">ğŸŒ¸ Fertility</a>
                </div>
            </div>
            
            <!-- Progress Dropdown -->
            <div class="dropdown">
                <button class="button dropdown-btn" onclick="toggleDropdown(event, 'progress-menu')">ğŸ“ˆ Progress â–¼</button>
                <div id="progress-menu" class="dropdown-content">
                    <a href="/metrics/summary/">ğŸ“ Metrics</a>
                    <a href="/milestones/list/">ğŸ¯ Milestones</a>
                </div>
            </div>
            
            <!-- Social Dropdown -->
            <div class="dropdown">
                <button class="button dropdown-btn" onclick="toggleDropdown(event, 'social-menu')">ğŸ‘¥ Social â–¼</button>
                <div id="social-menu" class="dropdown-content">
                    <a href="/users/users/">ğŸ” Find Friends</a>
                    <a href="/social/groups/">ğŸ‘« Groups</a>
                    <a href="/notifications/list/">ğŸ”” Notifications</a>
                </div>
            </div>
        </nav>
    {% else %}
        <header class="card" style="display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1rem;text-align:center;">
            <div style="display:flex;justify-content:center;align-items:center;gap:2.5rem;">
                <img src="{% static 'icons/apple-doodle.svg' %}" class="icon" alt="Meals">
                <img src="{% static 'icons/heart-doodle.svg' %}" class="icon" alt="Health">
                <img src="{% static 'icons/checklist-doodle.svg' %}" class="icon" alt="Habits">
                <img src="{% static 'icons/calendar-doodle.svg' %}" class="icon" alt="Fertility">
                <img src="{% static 'icons/user-doodle.svg' %}" class="icon" alt="Profile">
            </div>
            <h1 style="margin-top:1rem;margin-bottom:0;font-family:'Fredoka One','Comic Neue',sans-serif;font-size:2.5rem;">
                <a href="/" style="color:#4FC3F7;text-decoration:none;">GetLizzyFit</a>
            </h1>
        </header>
        <nav class="card" style="display:flex;flex-wrap:wrap;gap:1rem;align-items:center;justify-content:center;margin-bottom:2rem;">
            <a href="/accounts/login/" class="button">Login</a>
        </nav>
    {% endif %}
    
    <!-- Django Messages -->
    {% if messages %}
        <div style="max-width: 900px; margin: 1rem auto; width: 90%;">
            {% for message in messages %}
                <div class="{% if message.tags %}message-{{ message.tags }}{% endif %}" 
                     style="background: {% if message.level_tag == 'success' %}#C8E6C9{% elif message.level_tag == 'error' %}#FFCDD2{% elif message.level_tag == 'warning' %}#FFF9C4{% else %}#BBDEFB{% endif %}; 
                            border: 2px solid {% if message.level_tag == 'success' %}#81C784{% elif message.level_tag == 'error' %}#E57373{% elif message.level_tag == 'warning' %}#FFD54F{% else %}#64B5F6{% endif %}; 
                            border-radius: 1rem; 
                            padding: 1rem 1.5rem; 
                            margin-bottom: 1rem; 
                            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                            font-size: 1.1rem;
                            color: #333;">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}
    
    <main class="main-section">
        {% block content %}
            {% if user.is_authenticated %}
                <div class="section-title">Welcome back, {{ user.username }}!</div>
            {% else %}
                <div class="welcome-title">Welcome to GetLizzyFit!</div>
                <div class="welcome-desc">
                    GetLizzyFit is your all-in-one health, fitness, and wellness tracker. Log your meals, track your habits, monitor your health metrics, and connect with friends for motivation. Our app helps you build healthy routines, celebrate milestones, and stay on top of your goals in a fun, supportive environment.
                </div>
                <div class="feature-card">
                    <img src="{% static 'icons/apple-doodle.svg' %}" class="feature-icon" alt="Meals">
                    <div class="feature-info">
                        <div class="feature-title">Meal Logging</div>
                        <div class="feature-desc">Easily log your daily meals, track nutrition, and spot healthy eating patterns.</div>
                    </div>
                </div>
                <div class="feature-card">
                    <img src="{% static 'icons/heart-doodle.svg' %}" class="feature-icon" alt="Health">
                    <div class="feature-info">
                        <div class="feature-title">Health Metrics</div>
                        <div class="feature-desc">Monitor your health stats, including weight, heart rate, and more, all in one place.</div>
                    </div>
                </div>
                <div class="feature-card">
                    <img src="{% static 'icons/checklist-doodle.svg' %}" class="feature-icon" alt="Habits">
                    <div class="feature-info">
                        <div class="feature-title">Habit Tracking</div>
                        <div class="feature-desc">Build and maintain healthy habits with daily tracking and reminders.</div>
                    </div>
                </div>
                <div class="feature-card">
                    <img src="{% static 'icons/calendar-doodle.svg' %}" class="feature-icon" alt="Fertility">
                    <div class="feature-info">
                        <div class="feature-title">Fertility & Calendar</div>
                        <div class="feature-desc">Track fertility cycles and important dates with our integrated calendar.</div>
                    </div>
                </div>
                <div class="feature-card">
                    <img src="{% static 'icons/user-doodle.svg' %}" class="feature-icon" alt="Profile">
                    <div class="feature-info">
                        <div class="feature-title">Social & Community</div>
                        <div class="feature-desc">Connect with friends, join groups, and celebrate milestones together.</div>
                    </div>
                </div>
            {% endif %}
        {% endblock %}
    </main>
    <footer style="text-align:center;margin-top:2rem;color:#81C784;font-size:1rem;">
        &copy; {{ now.year }} GetLizzyFit. All rights reserved.
    </footer>
    
    <script>
        // Toggle burger menu
        function toggleMenu() {
            const nav = document.getElementById('main-nav');
            const burger = document.getElementById('burger-menu');
            nav.classList.toggle('active');
            burger.classList.toggle('active');
        }
        
        // Toggle dropdown menus
        function toggleDropdown(event, menuId) {
            event.stopPropagation();
            const dropdown = event.target.closest('.dropdown');
            const allDropdowns = document.querySelectorAll('.dropdown');
            
            // Close other dropdowns
            allDropdowns.forEach(d => {
                if (d !== dropdown) {
                    d.classList.remove('active');
                }
            });
            
            // Toggle current dropdown
            dropdown.classList.toggle('active');
        }
        
        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.dropdown')) {
                document.querySelectorAll('.dropdown').forEach(d => {
                    d.classList.remove('active');
                });
            }
        });
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const nav = document.getElementById('main-nav');
            const burger = document.getElementById('burger-menu');
            
            if (nav && burger && nav.classList.contains('active')) {
                if (!nav.contains(event.target) && !burger.contains(event.target)) {
                    nav.classList.remove('active');
                    burger.classList.remove('active');
                }
            }
        });
    </script>
</body>
</html>
