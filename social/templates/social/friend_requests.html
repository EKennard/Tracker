{% extends 'base.html' %}
{% block title %}Friend Requests{% endblock %}
{% block content %}

<h1 class="card" style="font-size:2rem;font-weight:bold;margin-bottom:1rem;">ğŸ‘¥ Friends & Requests</h1>

<!-- Pending Requests Received -->
{% if pending_received %}
<div class="card" style="margin-bottom:1.5rem;border:2px solid #FFB74D;">
  <h2 style="font-size:1.3rem;font-weight:bold;color:#FFB74D;margin-bottom:1rem;">
    ğŸ“¬ Pending Requests ({{ pending_received.count }})
  </h2>
  
  <div style="display:flex;flex-direction:column;gap:1rem;">
    {% for friendship in pending_received %}
    <div style="border:2px solid #FFB74D;padding:1rem;border-radius:0.5rem;background:#FFF8E1;">
      <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;">
        <div>
          <h3 style="margin:0 0 0.5rem 0;">ğŸ‘¤ {{ friendship.from_user.user.username }}</h3>
          <p style="margin:0;color:#666;font-size:0.9rem;">
            Sent {{ friendship.created_at|timesince }} ago
          </p>
        </div>
        <div style="display:flex;gap:0.5rem;flex-wrap:wrap;">
          <a href="{% url 'accept_friend_request' friendship.id %}" class="button" style="background:#81C784;text-decoration:none;">
            âœ“ Accept
          </a>
          <a href="{% url 'decline_friend_request' friendship.id %}" class="button" style="background:#E57373;text-decoration:none;">
            âœ— Decline
          </a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

<!-- Your Friends -->
<div class="card" style="margin-bottom:1.5rem;">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;flex-wrap:wrap;gap:1rem;">
    <h2 style="font-size:1.3rem;font-weight:bold;color:#4FC3F7;margin:0;">
      âœ“ My Friends ({{ friends.count }})
    </h2>
    <a href="{% url 'search_users' %}" class="button" style="text-decoration:none;">
      ğŸ” Find More Friends
    </a>
  </div>
  
  {% if friends %}
    <div style="display:grid;grid-template-columns:repeat(auto-fill, minmax(250px, 1fr));gap:1rem;">
      {% for friend in friends %}
      <div style="border:2px solid #81C784;padding:1rem;border-radius:0.5rem;background:#F1F8E9;">
        <h3 style="margin:0 0 0.5rem 0;color:#4FC3F7;">ğŸ‘¤ {{ friend.user.username }}</h3>
        <div style="font-size:0.85rem;color:#666;margin-bottom:0.5rem;">
          <code style="background:#E1F5FE;padding:0.25rem 0.5rem;border-radius:0.25rem;">{{ friend.personal_key }}</code>
        </div>
        {% if friend.goal %}
          <p style="margin:0;color:#666;font-size:0.9rem;font-style:italic;">Goal: {{ friend.goal }}</p>
        {% endif %}
      </div>
      {% endfor %}
    </div>
  {% else %}
    <div style="text-align:center;padding:3rem;color:#999;">
      <div style="font-size:3rem;margin-bottom:1rem;">ğŸ‘¥</div>
      <p>You don't have any friends yet.</p>
      <p style="font-size:0.9rem;margin-top:0.5rem;">Search for friends using their personal key or username!</p>
    </div>
  {% endif %}
</div>

<!-- Pending Requests Sent -->
{% if pending_sent %}
<div class="card">
  <h2 style="font-size:1.3rem;font-weight:bold;color:#999;margin-bottom:1rem;">
    â³ Requests Sent ({{ pending_sent.count }})
  </h2>
  
  <div style="display:flex;flex-direction:column;gap:1rem;">
    {% for friendship in pending_sent %}
    <div style="border:2px solid #DDD;padding:1rem;border-radius:0.5rem;background:#F5F5F5;">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <h3 style="margin:0 0 0.5rem 0;">ğŸ‘¤ {{ friendship.to_user.user.username }}</h3>
          <p style="margin:0;color:#666;font-size:0.9rem;">
            Waiting for response...
          </p>
        </div>
        <span style="color:#999;">â³</span>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

{% endblock %}
