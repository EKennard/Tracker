{% extends 'base.html' %}
{% block title %}Groups{% endblock %}
{% block content %}

<h1 class="card" style="font-size:2rem;font-weight:bold;margin-bottom:1rem;">ðŸ‘¥ Groups</h1>

<!-- Group Invitations -->
{% if invitations %}
<div class="card" style="margin-bottom:1.5rem;border:2px solid #FFB74D;">
  <h2 style="font-size:1.3rem;font-weight:bold;color:#FFB74D;margin-bottom:1rem;">
    ðŸ“¨ Group Invitations ({{ invitations.count }})
  </h2>
  
  <div style="display:flex;flex-direction:column;gap:1rem;">
    {% for invitation in invitations %}
    <div style="border:2px solid #FFB74D;padding:1rem;border-radius:0.5rem;background:#FFF8E1;">
      <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;">
        <div>
          <h3 style="margin:0 0 0.5rem 0;">{{ invitation.group.name }}</h3>
          <p style="margin:0;color:#666;font-size:0.9rem;">
            Invited by {{ invitation.from_user.user.username }}
          </p>
        </div>
        <div style="display:flex;gap:0.5rem;">
          <a href="{% url 'accept_group_invitation' invitation.id %}" class="button" style="background:#81C784;text-decoration:none;">
            âœ“ Accept
          </a>
          <a href="{% url 'decline_group_invitation' invitation.id %}" class="button" style="background:#E57373;text-decoration:none;">
            âœ— Decline
          </a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endif %}

<!-- Create Group -->
<div class="card" style="margin-bottom:1.5rem;">
  <form method="post">
    {% csrf_token %}
    <div class="form-section">
      <h2>âž• Create New Group</h2>
      {{ form.non_field_errors }}
    </div>
    <div class="form-grid">
      <div>
        <label>{{ form.name.label }}</label>
        {{ form.name }}
      </div>
      <div class="form-grid-full">
        <label>{{ form.description.label }}</label>
        {{ form.description }}
      </div>
      <div>
        <label style="display:flex;align-items:center;cursor:pointer;">
          {{ form.is_public }}
          <span style="margin-left:0.5rem;">Make group public (searchable)</span>
        </label>
      </div>
    </div>
    <button type="submit" class="button" style="margin-top:1.5rem;">ðŸ’¾ Create Group</button>
  </form>
</div>

<!-- Your Groups -->
<div class="card">
  <h2 style="font-size:1.3rem;font-weight:bold;color:#4FC3F7;margin-bottom:1rem;">
    My Groups ({{ my_groups.count }})
  </h2>
  
  {% if my_groups %}
    <div style="display:grid;grid-template-columns:repeat(auto-fill, minmax(300px, 1fr));gap:1rem;">
      {% for group in my_groups %}
      <div style="border:2px solid #4FC3F7;padding:1.5rem;border-radius:0.5rem;background:#F0F8FF;">
        <h3 style="margin:0 0 0.5rem 0;color:#BA68C8;">{{ group.name }}</h3>
        {% if group.description %}
          <p style="margin:0 0 1rem 0;color:#666;font-size:0.9rem;">{{ group.description }}</p>
        {% endif %}
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:1rem;">
          <span style="color:#666;font-size:0.85rem;">
            ðŸ‘¤ {{ group.members.count }} member{{ group.members.count|pluralize }}
          </span>
          <a href="{% url 'group_detail' group.id %}" class="button" style="text-decoration:none;font-size:0.9rem;padding:0.5rem 1rem;">
            View â†’
          </a>
        </div>
      </div>
      {% endfor %}
    </div>
  {% else %}
    <div style="text-align:center;padding:3rem;color:#999;">
      <div style="font-size:3rem;margin-bottom:1rem;">ðŸ‘¥</div>
      <p>You're not in any groups yet.</p>
      <p style="font-size:0.9rem;margin-top:0.5rem;">Create a group or wait for an invitation!</p>
    </div>
  {% endif %}
</div>

{% endblock %}